# PDF → JPG Converter

Кроссплатформенное приложение для конвертации PDF в JPG с графическим интерфейсом на **PyQt5**, реализованное с акцентом на читаемость кода, строгую типизацию, логирование и тестирование. Проект готов для разработки, отладки и упаковки в исполняемый артефакт.

---

## Обзор

**Кратко:** приложение рендерит каждую страницу PDF в изображение и сохраняет в формате JPEG. Поддерживается Windows, Linux и macOS. GUI реализован на PyQt5, рендеринг PDF выполняется через PyMuPDF, сохранение изображений через Pillow. Проект организован по шаблону «src layout» и снабжён unit тестами и конфигурацией для разработки.

**Цели проекта**
- Надёжная кроссплатформенная конвертация PDF → JPG.
- Удобный GUI с фоновыми задачами.
- Чистая архитектура, PEP 8, строгая типизация.
- Логирование и тесты для CI.

---

## Возможности

- **Конвертация по страницам** — каждая страница PDF сохраняется как отдельный JPG.
- **Кроссплатформенность** — работает на Windows, Linux, macOS.
- **GUI** — выбор файла и папки вывода, прогресс выполнения, уведомления об ошибках.
- **Фоновые задачи** — конвертация выполняется в отдельном потоке, интерфейс остаётся отзывчивым.
- **Логирование** — консоль и файл с ротацией.
- **Тесты** — pytest для модулей конвертации.
- **Строгая типизация** — аннотации типов, совместимость с mypy.

---

## Быстрый старт

### Клонирование репозитория
```bash
git clone https://github.com/IC1101E3/pdf2jpg_service.git
cd pdf2jpg_service
```

### Создание виртуального окружения
```bash
python -m venv .venv
# Linux macOS
source .venv/bin/activate
# Windows PowerShell
.venv\Scripts\Activate.ps1
```

### Установка зависимостей
```bash
pip install -r requirements.txt
```

### Запуск приложения
```bash
python -m src.pdf2jpg_service.main
```

---

## Установка для разработки

### Установка в editable режиме
```bash
pip install -e .
```

**Примечание:** если при установке возникла ошибка, проверьте `setup.cfg` и секцию `options.packages.find` с `where = src` и `exclude = tests`.

---

## Использование

### Графический интерфейс
- Нажмите **Выбрать PDF** и укажите файл.
- Нажмите **Выбрать папку вывода** и укажите директорию.
- Нажмите **Конвертировать**.
- По завершении появится уведомление с количеством сохранённых файлов.

### Программный вызов из Python
```python
from pathlib import Path
from pdf2jpg_service.converter import convert_pdf_to_jpg

pdf = Path("example.pdf")
out = Path("out_images")
saved = convert_pdf_to_jpg(pdf, out, dpi=150)
print(saved)
```

---

## Структура проекта

```
pdf2jpg_service/
├── README.md                       # Это руководство
├── pyproject.toml                  # содержит конфигурацию сборки
├── requirements.txt                # Список зависимостей
├── setup.cfg                       # Конфигурация проекта
└── .gitignore                      # Игнорируемые файлы (venv, __pycache__ и т.д.)
├── src/
│   └── pdf2jpg_service/
│       ├── __init__.py             # Маркер пакета (пустой)
│       ├── main.py                 # точка входа (CLI/запуск GUI)
│       ├── gui.py                  # PyQt5 интерфейс
│       ├── converter.py            # логика конвертации PDF -> JPG
│       ├── config.py               # константы и конфигурация
│       └── logger_setup.py         # настройка логгирования
├── tests/                          # Unit-тесты
│   ├── __init__.py                 # Маркер пакета (пустой)
│   └── test_converter.py           # Тесты для модуля converter
└── docs/                           # Документация
    └── architecture.md             # Архитектура проекта pdf2jpg_service
└── LICENSE                         # Файл лицензии 
```

**Ключевые модули**
- **converter.py** — логика рендеринга и сохранения изображений.
- **gui.py** — PyQt5 интерфейс и фоновые задачи.
- **logger_setup.py** — конфигурация логирования.
- **config.py** — константы проекта.

---

## Команды и сценарии

| Команда | Описание |
|---|---|
| `python -m src.pdf2jpg_service.main` | Запуск GUI приложения |
| `pip install -e .` | Установка пакета в editable режиме |
| `pytest -q` | Запуск тестов |
| `PYTHONPATH=src pytest -q` | Запуск тестов без установки пакета |

---

## Разработка и качество кода

- **Стандарты:** PEP 8, PEP 484 для аннотаций типов.
- **Форматирование:** рекомендуется использовать `black`.
- **Статическая проверка:** `mypy` для проверки типов.
- **Линтинг:** `flake8` с конфигурацией в `setup.cfg`.

### Рекомендованные команды
```bash
# Форматирование
black src tests

# Статическая проверка типов
mypy src

# Линтинг
flake8 src tests
```

---

## Тестирование

- Тесты находятся в каталоге `tests`.
- Для запуска:
```bash
pytest -q
```
- Если пакет не установлен, запустите:
```bash
PYTHONPATH=src pytest -q
```

**Советы по написанию тестов**
- Тестируйте конвертацию на временных файлах.
- Избегайте GUI тестов в unit тестах; GUI можно тестировать интеграционно вручную или с инструментами для GUI тестирования.

---

## Упаковка и распространение

- Для сборки wheel:
```bash
python -m build
```
- Для создания исполняемого файла используйте `PyInstaller`:
```bash
pyinstaller --onefile -n pdf2jpg_service src/pdf2jpg_service/main.py
```
**Примечание:** при упаковке с PyInstaller проверьте включение зависимостей PyQt5 и PyMuPDF.

---

## Отладка и устранение проблем

- **Ошибка импорта пакета в тестах**
  - Решение: установить пакет в editable режиме `pip install -e .` или запускать `PYTHONPATH=src pytest -q`.
- **Проблемы с Pillow и libjpeg**
  - Решение: установить системные библиотеки для вашей ОС или использовать бинарные колёса Pillow.
- **GUI не запускается**
  - Решение: проверьте, что активировано виртуальное окружение и установлены PyQt5.
- **Большое потребление памяти**
  - Решение: уменьшите `dpi` в `config.py` или измените логику конвертации, чтобы рендерить и сохранять страницы по одной.

---

## Вклад и правила участия

- **Форк** репозитория и создание pull request.
- **Стиль кода:** соблюдайте PEP 8 и используйте `black`.
- **Тесты:** добавляйте тесты для новой функциональности.
- **Commit messages:** ясные и описательные сообщения.
- **Issue:** создавайте issue с описанием проблемы и шагами для воспроизведения.

---

## Лицензия

Этот проект распространяется под лицензией MIT. См. файл [LICENSE](LICENSE) для деталей.

## Автор

- [IC1101E3] (https://github.com/IC1101E3)

Дата создания: Январь 2026. Если у вас есть вопросы, создайте issue на GitHub.
